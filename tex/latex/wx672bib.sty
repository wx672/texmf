\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{wx672bib}

\RequirePackage{ifxetex} % This class can only be processed with XeTeX

% without this, the Chinese in bib files will cause compiling error.
%\RequirePackage[utf8]{inputenc} % this pkg shouldn't used with xelatex!

\RequirePackage[backend=biber,
style=chem-angew,sorting=none,
%style=caspervector,sorting=centy,utf8,
hyperref=true,doi=false,isbn=false,%url=false,
date=iso,seconds=true]{biblatex}

\let\cite=\supercite
\renewcommand*{\bibfont}{\small} % 11pt

% https://tex.stackexchange.com/questions/23832/biblatex-make-title-hyperlink-to-doi-url-if-available
\newbibmacro{string+url}[1]{%
  \iffieldundef{url}{#1}{\href{\thefield{url}}{#1}}}

\DeclareFieldFormat{title}{\usebibmacro{string+url}{\mkbibemph{#1}}}

% \DeclareFieldFormat[article]{title}{\usebibmacro{string+url}{\mkbibquote{#1}}}

% citetitle (for handouts)
% https://tex.stackexchange.com/questions/284207/how-to-cite-the-title-and-the-year-in-the-same-command
\DeclareCiteCommand{\citetitle}
{\boolfalse{citetracker}\boolfalse{pagetracker}}
{\ifciteindex{\indexfield{indextitle}}{}%
  \printtext[brackets]{%
    \usebibmacro{prenote}\printfield[citetitle]{title}%
    \usebibmacro{postnote}}}%
{\multicitedelim}{}