% è¥¿å—æ—ä¸šå¤§å­¦æœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ã€å®ä¹ è®¡åˆ’è¡¨ï¼ˆå­¦ç”Ÿå¡«å†™ï¼‰ã€åŠä¸­æœŸæ£€æŸ¥è¡¨
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{swfu4in1}

% pass unknown options to ctexart
\DeclareOption*{\PassOptionsToClass{\CurrentOption}{ctexart}}
\ProcessOptions\relax

\LoadClass[scheme=chinese]{ctexart}

\ctexset{%
  section={%
    format={\kaishu\zihao{-4}\bfseries},%
    number={\chinese{section}ã€},%
    beforeskip=1.2ex,%
    afterskip=1.2ex,%
    aftername=\hspace{1ex}%
  },%
  subsection={%
    format={\zihao{-4}\bfseries },%
    number={\arabic{subsection}. },%
    beforeskip=1.2ex,%
    afterskip=1.2ex,%
    aftername=\hspace{1ex}%
  },%
  subsubsection={%
    format={\songti\zihao{-4}},%
    name={,)\,},%
    number={\arabic{subsubsection}\)},%
    beforeskip=2pt,afterskip=2pt,%
    aftername=\hspace{2pt}%
  }
}

\setcounter{secnumdepth}{3}

%\newfontfamily\nerd{FiraCode Nerd Font Mono}
\newfontfamily\nerd{Noto Sans Symbols2}
% \RequirePackage{newunicodechar}
% \newunicodechar{â–¡}{{\large\nerd â–¡}}%ballot box
% \newunicodechar{â˜‘}{{\large\nerd â˜‘}}%checked box
\newcommand\unchecked{{\large\nerd â–¡}} %ballot box
\newcommand\checked{{\large\nerd â˜‘}} %ğŸ—¹

\RequirePackage{pgfkeys}

\pgfkeys{%
  Advisora/.store in       = \SWFU@Advisora,       Advisora={ç‹æ™“æ—}, % æŒ‡å¯¼æ•™å¸ˆa
  Advisorb/.store in       = \SWFU@Advisorb,       Advisorb=,        % æŒ‡å¯¼æ•™å¸ˆb
  AdvisoraTitle/.store in  = \SWFU@AdvisoraTitle,  AdvisoraTitle={è®²å¸ˆ}, % æŒ‡å¯¼æ•™å¸ˆaèŒç§°
  AdvisorbTitle/.store in  = \SWFU@AdvisorbTitle,  AdvisorbTitle=,  % æŒ‡å¯¼æ•™å¸ˆbèŒç§°
  AdvisoraSig/.store in    = \SWFU@AdvisoraSig,
  AdvisoraSig={\includegraphics[width=3cm]{Albus}},    % æŒ‡å¯¼æ•™å¸ˆaç­¾å
  AdvisorbSig/.store in    = \SWFU@AdvisorbSig,    AdvisorbSig=,    % æŒ‡å¯¼æ•™å¸ˆbç­¾å
  AdvisoraGender/.store in = \SWFU@AdvisoraGender, AdvisoraGender={ç”·}, % æŒ‡å¯¼æ•™å¸ˆaæ€§åˆ«
  AdvisorbGender/.store in = \SWFU@AdvisorbGender, AdvisorbGender=, % æŒ‡å¯¼æ•™å¸ˆbæ€§åˆ«
  AdvisoraAge/.store in    = \SWFU@AdvisoraAge,    AdvisoraAge={53}, % æŒ‡å¯¼æ•™å¸ˆaå¹´é¾„
  AdvisorbAge/.store in    = \SWFU@AdvisorbAge,    AdvisorbAge=,    % æŒ‡å¯¼æ•™å¸ˆbå¹´é¾„
  AdvisoraDegree/.store in = \SWFU@AdvisoraDegree, AdvisoraDegree={ç¡•å£«}, % æŒ‡å¯¼æ•™å¸ˆaå­¦ä½
  AdvisorbDegree/.store in = \SWFU@AdvisorbDegree, AdvisorbDegree=, % æŒ‡å¯¼æ•™å¸ˆbå­¦ä½
  AdvisoraFrom/.store in   = \SWFU@AdvisoraFrom, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰æŒ‡å¯¼æ•™å¸ˆaå·¥ä½œå•ä½
  AdvisorbFrom/.store in   = \SWFU@AdvisorbFrom, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰æŒ‡å¯¼æ•™å¸ˆbå·¥ä½œå•ä½
  AdvisoraFrom = {å¤§æ•°æ®ä¸æ™ºèƒ½å·¥ç¨‹å­¦é™¢},%a
  AdvisorbFrom =,%b  
  DeptAdmin/.store in = \SWFU@DeptAdmin, DeptAdmin=, %(å¼€é¢˜æŠ¥å‘Š) æ•™ç ”å®¤è´Ÿè´£äºº
  SchoolAdmin/.store in = \SWFU@SchoolAdmin, SchoolAdmin=, %(å¼€é¢˜æŠ¥å‘Š) æ•™å­¦é™¢ç³»éƒ¨è´Ÿè´£äºº
  Studid/.store in        = \SWFU@Studid,  % å­¦å·
  Subject/.store in       = \SWFU@Subject, Subject={è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯},% ä¸“ä¸š
  Grade/.store in         = \SWFU@Grade,   % å¹´çº§
  StudSignature/.store in = \SWFU@StudSignature,%ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿç­¾å
  TaskDate/.store in = \SWFU@TaskDate, TaskDate={2021å¹´11æœˆ12æ—¥},%ï¼ˆä»»åŠ¡ä¹¦ï¼‰ä»»åŠ¡ä¸‹è¾¾æ—¥æœŸ
  SubmitDate/.store in = \SWFU@SubmitDate, SubmitDate={2022å¹´4æœˆ25æ—¥},%ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿåº”é€äº¤æ¯•ä¸šè®ºæ–‡æ—¥æœŸ
  StudSignature           ={\includegraphics[width=25mm]{Harry}},%
  School/.store in        = \SWFU@School,   %ï¼ˆå®ä¹ è®¡åˆ’è¡¨ï¼‰å­¦ç”Ÿæ‰€å±å­¦é™¢
  School = {å¤§æ•°æ®ä¸æ™ºèƒ½å·¥ç¨‹å­¦é™¢},%
  Gyear/.store in = \SWFU@Gyear, Gyear = \the\year,%ï¼ˆä»»åŠ¡ä¹¦ã€å®ä¹ è®¡åˆ’è¡¨ï¼‰å±Š
  % Year/.store in  = \SWFU@Year, %ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å¡«è¡¨ã€ç­¾å­—æ—¶é—´ï¼ˆå¹´ï¼‰
  % Month/.store in = \SWFU@Month,%ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å¡«è¡¨ã€ç­¾å­—æ—¶é—´ï¼ˆæœˆï¼‰
  Date/.store in  = \SWFU@Date, Date={\today}, %ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å¡«è¡¨ã€ç­¾å­—æ—¶é—´ï¼ˆå¹´ã€æœˆã€æ—¥ï¼‰
  PrjFrmA/.store in  = \SWFU@PrjFrmA, PrjFrmA={\unchecked{}},   %ç§‘ç ”é¡¹ç›®
  PrjFrmB/.store in  = \SWFU@PrjFrmB, PrjFrmB={\unchecked{}},   %ç¤¾ä¼šå®è·µ
  PrjFrmC/.store in  = \SWFU@PrjFrmC, PrjFrmC={\unchecked{}},   %å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®
  PrjFrmD/.store in  = \SWFU@PrjFrmD, PrjFrmD={\unchecked{}},   %å…¶å®ƒæ¥æº
  PrjTypeA/.store in = \SWFU@PrjTypeA, PrjTypeA={\unchecked{}}, %æ¯•ä¸šè®ºæ–‡
  PrjTypeB/.store in = \SWFU@PrjTypeB, PrjTypeB={\checked{}},   %æ¯•ä¸šè®¾è®¡
  AdvisorComment/.store in = \SWFU@AdvisorComment, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰æŒ‡å¯¼æ•™å¸ˆæ„è§
  AdvisorComment={åŒæ„å¼€é¢˜ã€‚},%
  PPSLi/.store in  = \SWFU@PPSLi,    %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰1. è¯¥ç ”ç©¶çš„ç›®çš„ã€æ„ä¹‰
  PPSLii/.store in = \SWFU@PPSLii,   %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰2. å›½å†…å¤–ç ”ç©¶ç°çŠ¶åŠå‘å±•è¶‹åŠ¿
  BIB/.store in    = \SWFU@BIB,      %ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å‚è€ƒæ–‡çŒ®
  PPSLiv/.store in = \SWFU@PPSLiv,   %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰4. è¯¥ç ”ç©¶çš„ä¸»è¦å†…å®¹ï¼Œé‡ç‚¹è§£å†³çš„é—®é¢˜ï¼Œ
                                     %             é¢„æœŸç»“æœæˆ–æˆæœ
  PPSLv/.store in  = \SWFU@PPSLv,    %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰5. æ‹Ÿé‡‡å–çš„ç ”ç©¶æ–¹æ³•æˆ–å®éªŒæ–¹æ³•ï¼Œæ­¥éª¤ï¼Œ
                                     %             å¯èƒ½å‡ºç°çš„æŠ€æœ¯é—®é¢˜åŠè§£å†³åŠæ³•
  PPSLvi/.store in = \SWFU@PPSLvi,   %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰6. å®Œæˆè¯¥ç ”ç©¶å·²å…·å¤‡çš„æ¡ä»¶  
  TSKwhy/.store in  = \SWFU@TSKwhy,  %ï¼ˆä»»åŠ¡ä¹¦ï¼‰é€‰é¢˜çš„ç›®çš„åŠæ„ä¹‰
  TSKwhat/.store in = \SWFU@TSKwhat, %ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿä»»åŠ¡åŠè¦æ±‚
  TSKwhen/.store in = \SWFU@TSKwhen, %ï¼ˆä»»åŠ¡ä¹¦ï¼‰è¿›åº¦å®‰æ’
  Plan/.store in    = \SWFU@Plan,    %ï¼ˆå®ä¹ è®¡åˆ’è¡¨ï¼‰è®ºæ–‡å·¥ä½œè®¡åˆ’å’Œé¢„æœŸç›®æ ‡æ‘˜è¦
  Prjdone/.store in         = \SWFU@Prjdone,        %(ä¸­æœŸæ£€æŸ¥è¡¨)ç›®å‰å·²å®Œæˆä»»åŠ¡
  Prjtodo/.store in         = \SWFU@Prjtodo,        %(ä¸­æœŸæ£€æŸ¥è¡¨)å°šéœ€å®Œæˆçš„ä»»åŠ¡
  Prjproblem/.store in      = \SWFU@Prjproblem,     %(ä¸­æœŸæ£€æŸ¥è¡¨)å­˜åœ¨çš„é—®é¢˜å’Œè§£å†³åŠæ³•
  AdvisorComments/.store in = \SWFU@AdvisorComments,%(ä¸­æœŸæ£€æŸ¥è¡¨)æŒ‡å¯¼æ•™å¸ˆè¯„è¯­
  AdvisorComments={è¿›åº¦ç¬¦åˆè¦æ±‚ï¼ŒæŠ“ç´§å®Œæˆè®ºæ–‡ã€‚},%
  Midchkdate/.store in = \SWFU@Midchkdate, Midchkdate={\today},%
}

\newcommand{\swfusetup}[1]{\pgfkeys{#1}}

\RequirePackage[%showframe,%showcrop,
top=3cm,bottom=2.5cm,left=3cm,right=2.5cm,
nomarginpar,headheight=15pt, % to avoid "headheight too small"
]{geometry}

\RequirePackage{graphicx}
\graphicspath{{./figs/}{./}{../}} %mind the trailing â€œ/â€

\RequirePackage{caption,subcaption}% \captionof{table|figure}{t|f}

\RequirePackage{tabularray}%tabularx,,longtable,booktabs,makecell,multicol,multirow,array

\RequirePackage{indentfirst,enumitem} % \setlist
\setlist{nosep} % kills all vertical spacing
% \setlist{itemsep=-.5ex}

%%%%% biblatex
\RequirePackage[backend=biber,%
style=gb7714-2015,gbpub=false,gbtype=false,gbpunctin=false,%
url=false,doi=false,isbn=false]{biblatex}

\renewcommand{\bibfont}{\zihao{5}\songti}

%\RequirePackage{wx672tcb} % tcolorbox
\RequirePackage[most]{tcolorbox}
\usetikzlibrary{calc}

\tcbset{%show bounding box,%
  enhanced, breakable, sharp corners, nobeforeafter,%
  colback=white, coltitle=black, colbacktitle=white, colframe=black,%
  bottomrule=.2pt, after skip=-1.5pt,%bottomrule at break=.5pt,
  before upper={\parindent 2em},%
  overlay middle={%
    \draw[line width=.2pt] (frame.north west)--(frame.north east);
    \draw[line width=.2pt] (frame.south west)--(frame.south east);%
  },%
  overlay last={%
    \draw[line width=.2pt] (frame.north west)--(frame.north east);},%
}

% for the proposal part
\newcounter{main}
\newtcolorbox[use counter=main]{mainbodybox}[1]{%
  boxrule=.4pt,titlerule=0pt,%
  fonttitle=\large\bfseries,%
  overlay unbroken and first={%
    \draw[line width=.2pt] (frame.south west)--(frame.south east);%
  },%
  title=\thetcbcounter. #1}

% for the taskspec part
% #1 - text width;
% #2 - title text.
\newtcolorbox{Titleleft}[2][2em]{% 
  frame hidden, left=40pt,%
  borderline={.4pt}{0pt}{black},% vlines
  borderline west={.4pt}{32pt}{black},% 2nd left vline
  overlay unbroken and first={%
    \node[anchor=center, text width=#1, font=\bfseries] at ($(frame.west)+(16pt,0)$) {#2};
    \draw[line width=.2pt] (frame.south west)--(frame.south east);% bottom hline
  },%
}

\newtcolorbox{titleleft}[1]{% 
  frame hidden, left=24pt,%
  borderline={.4pt}{0pt}{black},% vlines
  borderline west={.4pt}{18pt}{black},% 2nd left vline
  overlay unbroken and first={%
    \node[anchor=west, text width=1em] at (frame.west) {#1};
    \draw[line width=.2pt] (frame.south west)--(frame.south east);% bottom hline
  },%
}

% \singlespacing, \onehalfspacing, \doublespacing
\RequirePackage[doublespacing]{setspace}
\renewcommand\doublespacing{\setstretch{1.6}}

\setlength{\parindent}{2em}

\pagestyle{plain}

\newcommand{\PPSLtitlepage}{% Proposal title page
  \thispagestyle{empty}
  \begin{center}
    \makebox[14em][s]{\LARGE\heiti è¥¿å—æ—ä¸šå¤§å­¦}\\[5mm]
    \makebox[28em][s]{\LARGE\heiti æœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å¼€é¢˜æŠ¥å‘Š}\\[5mm]
    \vskip 3cm
    \begin{large}
      \begin{minipage}{1.0\linewidth}
        \begin{tblr}{width=\textwidth, colspec={@{}rX@{}}}
          \makebox[7em][s]{è®ºæ–‡ï¼ˆè®¾è®¡ï¼‰é¢˜ç›®}%
          &\makebox[0pt][t]{%
            \begin{minipage}[t]{30em}
              \begin{center}
                \parbox[t]{29em}{\centering\bfseries\Large\@title}
              \end{center}
            \end{minipage}}%
            \rule[-1.5ex]{30em}{.1pt}\par%
            \rule[-1.5ex]{30em}{.1pt}\\%
        \end{tblr}
      \end{minipage}
      \vskip 2cm
      \begin{minipage}{.8\linewidth}
        \begin{center}
          \begin{tblr}{%
              colspec={@{}rX[c]@{}},%
              rows={12mm,belowsep=-1pt},hline{2-Z}={2}{solid}}
            \makebox[7em][s]{ä¸“ä¸šåç§°}%
            & \SWFU@Subject\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å¹´çº§}%
            & \SWFU@Grade\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å­¦ç”Ÿå§“å}%
            & \@author\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å­¦ç”Ÿå­¦å·}%
            & \SWFU@Studid\\[-1ex]\cline{2-2}
            \makebox[7em][s]{æŒ‡å¯¼æ•™å¸ˆ (èŒç§°)}%
            & \SWFU@Advisora{}ï¼ˆ\SWFU@AdvisoraTitleï¼‰\\[-1ex]\cline{2-2}
            & \SWFU@Advisorb{} \SWFU@AdvisorbTitle\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å¡«è¡¨æ—¶é—´}%
            & \SWFU@Date{}\\[-1ex]\cline{2-2}
          \end{tblr}
        \end{center}
      \end{minipage}
    \end{large}
    \vfill
    {\heiti è¥¿å—æ—ä¸šå¤§å­¦æ•™åŠ¡å¤„åˆ¶}\\[1cm]
  \end{center}
  \clearpage}

\newcommand{\PPSLinstructionpage}{% Proposal instruction page
  \begin{center}
    \LARGE\bfseries\makebox[7em][s]{å¡«è¡¨è¯´æ˜}
  \end{center}
  \vskip 5ex
  \begin{itemize}
  \item[ä¸€ã€] å¼€é¢˜æŠ¥å‘Šå„é¡¹å†…å®¹è¦å®äº‹æ±‚æ˜¯ï¼Œé€æ¡è®¤çœŸå¡«å†™ï¼Œè¡¨è¾¾è¦æ˜ç¡®ã€ä¸¥è°¨ã€‚å¤–æ¥è¯­åº”ç”¨ä¸­æ–‡å’Œ
    è‹±æ–‡åŒæ—¶è¡¨è¾¾ï¼Œç¬¬ä¸€æ¬¡å‡ºç°çš„ç¼©å†™è¯ï¼Œé¡»æ³¨å‡ºå…¨ç§°ã€‚
  \item[äºŒã€] å¼€é¢˜æŠ¥å‘Šéœ€ç”¨è®¡ç®—æœºæ‰“å°ï¼Œä¸€å¾‹ä¸º A4 å¼€æœ¬ï¼Œäºå·¦ä¾§è£…è®¢æˆå†Œã€‚å„æ ç©ºæ ¼ä¸å¤Ÿæ—¶ï¼Œè¯·è‡ª
    è¡ŒåŠ é¡µã€‚
  \item[ä¸‰ã€] å¼€é¢˜æŠ¥å‘Šéœ€åœ¨ç¬¬å…«å­¦æœŸå¼€å­¦ä¹‹å‰å®Œæˆã€‚
  \item[å››ã€] å¼€é¢˜æŠ¥å‘Šéœ€è£…å…¥è¥¿å—æ—ä¸šå¤§å­¦æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰æ¡£æ¡ˆè¢‹ã€‚
  \end{itemize}
  \clearpage}

\newcommand{\PPSLmain}{% main part
  \begin{singlespace}
    \noindent
    \begin{tblr}{width=\linewidth,%
        colspec={|c|c|c|c|c|c|X[c]|},%
        rowspec={Q[m]|Q|Q|Q[m]}
      }%
      \hline
      \SetCell[r=3]{m,2em}{æŒ‡å¯¼\\æ•™å¸ˆ\\åŸºæœ¬\\æƒ…å†µ} & æŒ‡å¯¼æ•™å¸ˆå§“å & {æ€§\\åˆ«} &%
      {å¹´\\é¾„} & {å­¦å†æˆ–\\å­¦ä½} & {ä¸“ä¸šæŠ€æœ¯\\èŒåŠ¡æˆ–èŒç§°} &å·¥ä½œå•ä½\\
      & \SWFU@Advisora & \SWFU@AdvisoraGender & \SWFU@AdvisoraAge &%
      \SWFU@AdvisoraDegree & \SWFU@AdvisoraTitle & \SWFU@AdvisoraFrom\\
      \SWFU@Advisorb & \SWFU@AdvisorbGender & \SWFU@AdvisorbAge &%
      \SWFU@AdvisorbDegree & \SWFU@AdvisorbTitle & \SWFU@AdvisorbFrom\\
      {è¯¾é¢˜\\æ¥æº} & \SetCell[c=6]{m} %
      \qquad\SWFU@PrjFrmA{}ç§‘ç ”é¡¹ç›®%
      \qquad\SWFU@PrjFrmB{}ç¤¾ä¼šå®è·µ%
      \qquad\SWFU@PrjFrmC{}å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®%
      \qquad\SWFU@PrjFrmD{}å…¶å®ƒæ¥æº\\%
    \end{tblr}
  \end{singlespace}
  \vskip -2pt
  \begin{mainbodybox}{è¯¥ç ”ç©¶çš„ç›®çš„ã€æ„ä¹‰}
    \SWFU@PPSLi{}
  \end{mainbodybox}
  \begin{mainbodybox}{å›½å†…å¤–ç ”ç©¶ç°çŠ¶åŠå‘å±•è¶‹åŠ¿}
    \SWFU@PPSLii{}
  \end{mainbodybox}
  \begin{mainbodybox}{ä¸»è¦å‚è€ƒæ–‡çŒ®}
    \SWFU@BIB{}
  \end{mainbodybox}
  \begin{mainbodybox}{è¯¥ç ”ç©¶çš„ä¸»è¦å†…å®¹ï¼Œé‡ç‚¹è§£å†³çš„é—®é¢˜ï¼Œé¢„æœŸç»“æœæˆ–æˆæœ}
    \SWFU@PPSLiv{}
  \end{mainbodybox}
  \begin{mainbodybox}{æ‹Ÿé‡‡å–çš„ç ”ç©¶æ–¹æ³•æˆ–å®éªŒæ–¹æ³•ï¼Œæ­¥éª¤ï¼Œå¯èƒ½å‡ºç°çš„æŠ€æœ¯é—®é¢˜åŠè§£å†³åŠæ³•}
    \SWFU@PPSLv{}
  \end{mainbodybox}
  \begin{mainbodybox}{å®Œæˆè¯¥ç ”ç©¶å·²å…·å¤‡çš„æ¡ä»¶}
    \SWFU@PPSLvi{}
  \end{mainbodybox}
  \begin{mainbodybox}{æŒ‡å¯¼æ•™å¸ˆæ„è§}
    \bigskip
    \SWFU@AdvisorComment\par
    \hfill ç­¾åï¼š\makebox[7em]{\SWFU@AdvisoraSig}\par
    \medskip
    \hfill\SWFU@Date
  \end{mainbodybox}
  \noindent
  \begin{tcolorbox}[sharp corners,nobeforeafter,%
    left=0pt,right=0pt,top=-13pt,bottom=0pt,boxsep=0pt,%
    colback=white, boxrule=.5pt]
    \singlespacing\noindent
    \begin{tblr}{width=\linewidth,
        colspec={c|X|c|X},rowspec={Q[m]}}
      {æ•™\\ç ”\\å®¤\\æ„\\è§} &%
      \begin{minipage}[c][3.5cm]{1.0\linewidth}
        æ•™ç ”å®¤è´Ÿè´£äººï¼š%
        \begin{center}
          \SWFU@DeptAdmin
        \end{center}
        \vfill
        \hfill\SWFU@Date%{}å¹´\qquad{}æœˆ\qquad{}æ—¥%
      \end{minipage}
      & {æ•™\\å­¦\\é™¢\\ç³»\\éƒ¨\\æ„\\è§} &%
      \begin{minipage}[c][3.5cm]{1.0\linewidth}
        æ•™å­¦é™¢ç³»éƒ¨è´Ÿè´£äººï¼š
        \begin{center}
          \SWFU@SchoolAdmin
        \end{center}
        \vfill
        \hfill{}\SWFU@Date%å¹´\qquad{}æœˆ\qquad{}æ—¥          
      \end{minipage}\\
    \end{tblr}    
  \end{tcolorbox}%
}

\newcommand{\maketaskspec}{%
  \pagestyle{empty}
  {\centering\singlespacing%
    {\heiti\Large è¥¿å—æ—ä¸šå¤§å­¦\SWFU@Gyear{}å±Šæœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰ä»»åŠ¡ä¹¦}\\[3ex]%
    \begin{tblr}{width=\linewidth, vlines,hline{1,2,3},%
        colspec={cXcccX}, rowspec={Q[m]Q[m]Q[m]},%
        column{odd}={font=\bfseries},% column{even}={font=\kaishu},%
        cell{1}{2}={c=5}{c},%
        cell{3}{4}={c=3}{c},%
      }%
      {è®ºæ–‡ï¼ˆè®¾è®¡ï¼‰\\é¢˜ç›®} & {\@title}\\
      å­¦ç”Ÿå§“å & \@author & å­¦å· & \SWFU@Studid & ä¸“ä¸š & \SWFU@Subject\\
      é¢˜ç›®æ¥æº & {\SWFU@PrjFrmA{}ç§‘ç ”é¡¹ç›®\\\SWFU@PrjFrmB{}ç¤¾ä¼šå®è·µ\\
        \SWFU@PrjFrmC{}å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®\\\SWFU@PrjFrmD{}å…¶å®ƒ} &%
      {é¢˜ç›®\\ç±»åˆ«} &%
      {\SWFU@PrjTypeA{}æ¯•ä¸šè®ºæ–‡\qquad{}\SWFU@PrjTypeB{}æ¯•ä¸šè®¾è®¡}\\
    \end{tblr}\\\vspace*{-1pt}%
    \begin{titleleft}{é€‰é¢˜çš„ç›®çš„åŠæ„ä¹‰}
      \SWFU@TSKwhy
    \end{titleleft}
    \begin{titleleft}{å­¦ç”Ÿä»»åŠ¡åŠè¦æ±‚}
      \SWFU@TSKwhat
    \end{titleleft}
    \begin{titleleft}{è¿›åº¦å®‰æ’}
      \SWFU@TSKwhen
    \end{titleleft}
    \begin{titleleft}{å‚è€ƒæ–‡çŒ®}
      \SWFU@BIB
    \end{titleleft}
    \vspace*{1pt}
    \begin{tblr}{width=\linewidth, colspec={|c|X[c]|c|X[c]|}, hline{1}, rowspec={Q[m]|}}%
      ä»»åŠ¡ä¸‹è¾¾æ—¥æœŸ & \SWFU@TaskDate &%
      {å­¦ç”Ÿåº”é€äº¤æ¯•ä¸šè®ºæ–‡\\ï¼ˆè®¾è®¡ï¼‰æ—¥æœŸ} & \SWFU@SubmitDate\\
    \end{tblr}\\[-1pt]%
    \begin{tblr}{width=\linewidth,
        colspec={|c|X|c|X|}, rowspec={Q[m]|Q[m]|}}
      {æŒ‡å¯¼æ•™å¸ˆ\\ç­¾å­—}
      & \begin{minipage}[c][25mm]{1.0\linewidth}%
        \medskip%
        \makebox[3cm][r]{\SWFU@AdvisoraSig}\par%
        \vfill%
        \hfill\SWFU@Date{}%
        \medskip%
      \end{minipage} &%
      {æ¥å—ä»»åŠ¡\\å­¦ç”Ÿç­¾å­—} &%
      \begin{minipage}[c][25mm]{1.0\linewidth}%
        \medskip%
        \makebox[3cm][r]{\SWFU@StudSignature}\par%
        \vfill%
        \hfill\SWFU@Date{}%
        \medskip%
      \end{minipage}\\%
      {æ•™ç ”å®¤\\å®¡æ ¸} &%
      \begin{minipage}[c][35mm]{1.0\linewidth}%
        \par\vspace{1ex}%
        å®¡æ ¸æ„è§ï¼š\par
        \vfill%
        ç­¾å­—ï¼š\par%
        \hfill{}å¹´\qquad{}æœˆ\qquad{}æ—¥%
        \medskip
      \end{minipage} &%
      {å­¦é™¢å®¡æ ¸} &%
      \begin{minipage}[c][35mm]{1.0\linewidth}%
        \par\vspace{1ex}%
        å®¡æ ¸æ„è§ï¼š\par
        \vfill%
        ç­¾ç« ï¼š\par%
        \hfill\qquad{}å¹´\qquad{}æœˆ\qquad{}æ—¥%
        \medskip
      \end{minipage}\\
    \end{tblr}\\
    \begin{tblr}{width=\linewidth, colspec={@{}c@{\;}X@{}}} 
      æ³¨ï¼š&%
      {1. æ­¤ä»»åŠ¡ä¹¦ç”±æŒ‡å¯¼æ•™å¸ˆå¡«å†™ï¼Œå„é™¢å®¡å®šï¼Œåœ¨æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å¼€å§‹å‰ä¸€å‘¨å†…å¡«å¥½å¹¶å‘ç»™å­¦ç”Ÿã€‚\\
      2. æ­¤ä»»åŠ¡ä¹¦åŒé¢æ‰“å°ï¼Œä¸€å¼ä¸¤ä»½ã€‚å­¦ç”Ÿä¸€ä»½ï¼Œå¦ä¸€ä»½éšæ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰ä¿å­˜ã€‚}\\
    \end{tblr}}}

\newcommand\makeplan{%
  \thispagestyle{empty}
  \singlespacing
  {\centering\heiti\Large è¥¿å—æ—ä¸šå¤§å­¦\SWFU@Gyear{}å±Šæœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å®ä¹ è®¡åˆ’è¡¨\par}
  \bigskip
  \hfillï¼ˆæœ¬è¡¨ç”±æ¯•ä¸šç”Ÿå¡«å†™ï¼‰\par
  {\centering
    \begin{tblr}{width=\linewidth,
        colspec={|X[-1,c,font=\bfseries]|X[c]|}, rowspec={|Q|Q|}%,font=\kaishu
      }%
      è®ºæ–‡ï¼ˆè®¾è®¡ï¼‰é¢˜ç›®&\@title\\
    \end{tblr}
    \vskip -1pt
    \begin{tblr}{width=\linewidth, colspec={|c|X[c]|c|l|}, rowspec={Q[m]|},        
        column{odd}={font=\bfseries}}%, column{even}={font=\kaishu}
      {é¢˜ç›®\\ç±»åˆ«} & \SWFU@PrjTypeA{}æ¯•ä¸šè®ºæ–‡\qquad\SWFU@PrjTypeB{}æ¯•ä¸šè®¾è®¡ &%
      {é¢˜ç›®\\æ¥æº} & {\SWFU@PrjFrmA{}ç§‘ç ”é¡¹ç›®\quad\SWFU@PrjFrmB{}ç¤¾ä¼šå®è·µ\quad%
        \SWFU@PrjFrmD{}å…¶å®ƒæ¥æº\\\SWFU@PrjFrmC{}å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®}\\
    \end{tblr}
    \vskip -1pt
    \begin{tblr}{width=\linewidth,%
        colspec={|r|X[c]|r|X[c]|}, rowspec={Q[m]|Q[m]|},%
        column{odd}={font=\bfseries}}% , column{even}={font=\kaishu}
      æŒ‡å¯¼æ•™å¸ˆ&\SWFU@Advisora&èŒç§°&\SWFU@AdvisoraTitle\\
      è¾…åŠ©æŒ‡å¯¼æ•™å¸ˆ&\SWFU@Advisorb&èŒç§°&\SWFU@AdvisorbTitle\\
    \end{tblr}
    \vskip -1pt
    \begin{tblr}{width=\linewidth,%
        colspec={|c|X[-1,c]|c|X|c|X[-1,c]|}, column{odd}={font=\bfseries},
        rowspec={Q[m]|Q[m]|Q[m]|Q[m]|Q[m]|Q[m]|}
      }%
      å­¦ç”Ÿå§“å&\@author&ä¸“ä¸š&\SWFU@Subject&å­¦å·&\SWFU@Studid\\
      æ‰€å±å­¦é™¢&\SetCell[c=5]{m}\SWFU@School\\
    \end{tblr}
    \vskip -1pt
    \begin{tblr}{width=\linewidth, colspec={|X|},rowspec={Q[m]Q[m]|}}
      è®ºæ–‡å·¥ä½œè®¡åˆ’å’Œé¢„æœŸç›®æ ‡æ‘˜è¦ï¼š\\
      \begin{minipage}[t][15cm]{1.0\linewidth}
        \qquad{}\SWFU@Plan
      \end{minipage}\\
    \end{tblr}
    {\heiti æ³¨ï¼š}æ¯ä½æ¯•ä¸šç”Ÿé¡»å¡«å†™ä¸€ä»½ï¼›å¦‚è¡¨æ ä¸å¤Ÿå¡«å†™ï¼Œè¯·åŠ é™„é¡µã€‚
  }\clearpage}

\newcommand{\makeproposal}{%
  \PPSLtitlepage{}
  \PPSLinstructionpage{}
  \PPSLmain{}}

\newcommand\midchk{\pagestyle{empty}%
  {\centering\Large\heiti è¥¿å—æ—ä¸šå¤§å­¦æœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰ä¸­æœŸæ£€æŸ¥è¡¨\par}
  \medskip\noindent%
  \begin{tblr}{width=\linewidth,colspec={cX[c]cX[c]},hline{1-7},vlines,%
      cell{3-5}{2}={c=3}{c}, cell{7}{1}={c=4}{c},%
      cell{6}{2}={c=3}{l}}
    å­¦ç”Ÿå§“å&\@author&å­¦ç”Ÿå­¦å·&\SWFU@Studid\\
    ä¸“\quad{}ä¸š&\SWFU@Subject&æŒ‡å¯¼æ•™å¸ˆ&\SWFU@Advisora\\
    è®ºæ–‡é¢˜ç›® &{\@title}&&\\
    {ç›®å‰å·²å®Œ\\æˆä»»åŠ¡} & %
    \begin{tblr}{width=.85\textwidth,colspec={X},row{1}={2cm}{t},row{2}={f}}
        \SWFU@Prjdone\\
        \hfill{}æ˜¯å¦ç¬¦åˆè®¡åˆ’è¿›åº¦ï¼Ÿ\qquad\checked{}æ˜¯\quad\unchecked{}å¦\\
    \end{tblr} &&\\
    {å°šéœ€å®Œæˆ\\çš„ä»»åŠ¡} & %
    \begin{tblr}{width=.85\textwidth,colspec={X},row{1}={2cm}{t},row{2}={f}}
      \SWFU@Prjtodo\\
      \hfill{}èƒ½å¦æŒ‰æœŸå®Œæˆä»»åŠ¡ï¼Ÿ\qquad\checked{}æ˜¯\quad\unchecked{}å¦\\
    \end{tblr} &&\\
    {å­˜åœ¨çš„é—®\\é¢˜å’Œè§£å†³\\åŠæ³•} & %
    \begin{tblr}{width=.85\textwidth,colspec={X},row{1}={2cm}{t}}
      \SWFU@Prjproblem\\
    \end{tblr} &&\\% 
    \mbox{ï¼ˆä»¥ä¸Šéƒ¨åˆ†ç”±å­¦ç”Ÿå¡«å†™ï¼‰}&&&\\
  \end{tblr}\vspace{-1pt}
  \begin{titleleft}{æŒ‡å¯¼æ•™å¸ˆè¯„è¯­}
    \SWFU@AdvisorComments\par\bigskip%
    \hfill{}æŒ‡å¯¼æ•™å¸ˆï¼ˆç­¾åï¼‰ï¼š\makebox[3cm][c]{\SWFU@AdvisoraSig}\par\medskip%
    \hfill{}\SWFU@Midchkdate
  \end{titleleft}
  \noindent%
  \begin{tblr}{width=\linewidth,colspec={lccX[c]},hline{2-Z},vlines,%
      cell{1}{1}={c=4}{c}, cell{8}{1,3}={c=2}{c}, cell{2}{1}={c},%
    }
    \mbox{ï¼ˆä»¥ä¸‹éƒ¨åˆ†ç”±æ•™å­¦é™¢ã€ç³»ã€éƒ¨å¡«å†™ï¼‰}&&&\\
    {è¯„\, åˆ†\, é¡¹\, ç›®} &æœ€é«˜åˆ†å€¼&è¯„åˆ†&å¤‡\, æ³¨\\
    æŒ‡å¯¼æ•™å¸ˆå¯¹æ¯•ä¸šå®ä¹ çš„æŒ‡å¯¼åŠ›åº¦&25&&\\
    æ¯•ä¸šè®ºæ–‡çš„å®éªŒæ¡ä»¶&15&&\\
    æ¯•ä¸šè®ºæ–‡çš„é€‚åˆåº¦&20&&\\
    å®Œæˆè®ºæ–‡çš„è¿›åº¦&15&&\\
    å­¦ç”Ÿè¡¨ç°&25&&\\
    æ€»\qquad{}åˆ†&&&\\
  \end{tblr}
  \vskip -1.5pt\noindent%
  \begin{tblr}{width=\linewidth,colspec={cXcX},vlines,hline{2-Z},%
      column{1,3}={5mm,m},%
    }
    {æ•™ç ”å®¤æ„è§} & %
    \begin{minipage}[c][3cm]{\linewidth}
      \vfill{}%
      æ•™ç ”å®¤è´Ÿè´£äººï¼š\par%
      \hfill{}å¹´\qquad{}æœˆ\qquad{}æ—¥%
    \end{minipage} & %
    {å­¦é™¢æ„è§} & %
    \begin{minipage}[c][3cm]{\linewidth}
      \vfill{}
      å­¦é™¢è´Ÿè´£äººï¼š\par%
      \hfill{}å¹´\qquad{}æœˆ\qquad{}æ—¥
    \end{minipage}\\
  \end{tblr}}
