% è¥¿å—æ—ä¸šå¤§å­¦æœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ã€å®ä¹ è®¡åˆ’è¡¨ï¼ˆå­¦ç”Ÿå¡«å†™ï¼‰ã€åŠä¸­æœŸæ£€æŸ¥è¡¨
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{swfu4in1}

% pass unknown options to ctexart
\DeclareOption*{\PassOptionsToClass{\CurrentOption}{ctexart}}
\ProcessOptions\relax

\LoadClass[scheme=chinese]{ctexart}

% \ctexset{%
%   section={%
%     format={\kaishu\zihao{-4}\bfseries},%
%     number={\chinese{section}ã€},%
%     beforeskip=1.2ex,%
%     afterskip=1.2ex,%
%     aftername=\hspace{1ex}%
%   },%
%   subsection={%
%     format={\zihao{-4}\bfseries },%
%     number={\arabic{subsection}. },%
%     beforeskip=1.2ex,%
%     afterskip=1.2ex,%
%     aftername=\hspace{1ex}%
%   },%
%   subsubsection={%
%     format={\songti\zihao{-4}},%
%     name={,)\,},%
%     number={\arabic{subsubsection}\)},%
%     beforeskip=2pt,afterskip=2pt,%
%     aftername=\hspace{2pt}%
%   }
% }

% \defcounter{secnumdepth}{3}

\RequirePackage{calc,etoolbox}
\newcounter{age}
\defcounter{age}{\the\year - 1969} %AdvisoraAge

\newcounter{grade}
\defcounter{grade}{\the\year - 2}% Grade

\newcounter{lastyear}
\defcounter{lastyear}{\the\year - 1}%for \TaskDate

%%% check box
\RequirePackage{newunicodechar}
\newfontfamily\symbola{Symbola Nerd Font}
\newunicodechar{â˜}{{\symbola â˜}}%ballot box ğŸ—†
\newunicodechar{â˜‘}{{\symbola â˜‘}}%checked box tick ğŸ—¹

\RequirePackage{pgfkeys}
\pgfkeys{%
  Prjtitle/.store in = \SWFU@Prjtitle, %è®ºæ–‡é¢˜ç›®
  Advisora/.store in = \SWFU@Advisora, %æŒ‡å¯¼æ•™å¸ˆa
  Advisorb/.store in = \SWFU@Advisorb, %æŒ‡å¯¼æ•™å¸ˆb
  AdvisoraTitle/.store in = \SWFU@AdvisoraTitle, %æŒ‡å¯¼æ•™å¸ˆaèŒç§°
  AdvisorbTitle/.store in = \SWFU@AdvisorbTitle, %æŒ‡å¯¼æ•™å¸ˆbèŒç§°
  AdvisoraSig/.store in = \SWFU@AdvisoraSig, % æŒ‡å¯¼æ•™å¸ˆaç­¾å
  AdvisorbSig/.store in = \SWFU@AdvisorbSig, % æŒ‡å¯¼æ•™å¸ˆaç­¾å
  AdvisoraGender/.store in = \SWFU@AdvisoraGender, % æŒ‡å¯¼æ•™å¸ˆaæ€§åˆ«
  AdvisorbGender/.store in = \SWFU@AdvisorbGender, % æŒ‡å¯¼æ•™å¸ˆbæ€§åˆ«
  AdvisoraAge/.store in = \SWFU@AdvisoraAge, % æŒ‡å¯¼æ•™å¸ˆaå¹´é¾„ 
  AdvisorbAge/.store in = \SWFU@AdvisorbAge, % æŒ‡å¯¼æ•™å¸ˆbå¹´é¾„ 
  AdvisoraDegree/.store in = \SWFU@AdvisoraDegree, % æŒ‡å¯¼æ•™å¸ˆaå­¦ä½
  AdvisorbDegree/.store in = \SWFU@AdvisorbDegree, % æŒ‡å¯¼æ•™å¸ˆbå­¦ä½
  AdvisoraFrom/.store in = \SWFU@AdvisoraFrom, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰æŒ‡å¯¼æ•™å¸ˆaå·¥ä½œå•ä½
  AdvisorbFrom/.store in = \SWFU@AdvisorbFrom, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰æŒ‡å¯¼æ•™å¸ˆbå·¥ä½œå•ä½
  Studname/.store in = \SWFU@Studname, %å­¦ç”Ÿå§“å
  Studid/.store in   = \SWFU@Studid,   % å­¦å·
  School/.store in  = \SWFU@School,  %ï¼ˆå®ä¹ è®¡åˆ’è¡¨ï¼‰å­¦ç”Ÿæ‰€å±å­¦é™¢
  Subject/.store in = \SWFU@Subject, % ä¸“ä¸š
  Grade/.store in = \SWFU@Grade, % å¹´çº§
  Gyear/.store in = \SWFU@Gyear, %ï¼ˆä»»åŠ¡ä¹¦ã€å®ä¹ è®¡åˆ’è¡¨ï¼‰å±Š
  StudSig/.store    in = \SWFU@StudSig,   %ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿç­¾å
  DeptSig/.store    in = \SWFU@DeptSig,   %(å¼€é¢˜æŠ¥å‘Š) æ•™ç ”å®¤è´Ÿè´£äººç­¾å
  SchoolSig/.store  in = \SWFU@SchoolSig, %(å¼€é¢˜æŠ¥å‘Š) æ•™å­¦é™¢ç³»éƒ¨è´Ÿè´£äººç­¾å
  ReviewDate/.store in = \SWFU@ReviewDate, %ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰ç­¾å­—æ—¥æœŸ
  Date/.store       in = \SWFU@Date,       %ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å°é¢æ—¥æœŸ
  TaskDate/.store   in = \SWFU@TaskDate,   %ï¼ˆä»»åŠ¡ä¹¦ï¼‰ä»»åŠ¡ä¸‹è¾¾æ—¥æœŸ
  DueDate/.store    in = \SWFU@DueDate,    %ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿåº”é€äº¤æ¯•ä¸šè®ºæ–‡æ—¥æœŸ
  Midchkdate/.store in = \SWFU@Midchkdate, %ï¼ˆä¸­æœŸæ£€æŸ¥è¡¨ï¼‰æ—¥æœŸ
  AgreeD/.store     in = \SWFU@AgreeD, %ï¼ˆä¸­æœŸæ£€æŸ¥è¡¨ï¼‰æ•™ç ”å®¤æ„è§
  AgreeS/.store     in = \SWFU@AgreeS, %ï¼ˆä¸­æœŸæ£€æŸ¥è¡¨ï¼‰å­¦é™¢æ„è§
  %%% defaults
  DeptSig   ={\includegraphics[width=3cm]{qiangzhenping}}, %(å¼€é¢˜æŠ¥å‘Š) æ•™ç ”å®¤è´Ÿè´£äºº
  SchoolSig ={\includegraphics[width=3cm]{zhangqinghui}}, %(å¼€é¢˜æŠ¥å‘Š) æ•™å­¦é™¢ç³»éƒ¨è´Ÿè´£äºº
  AgreeD    ={\includegraphics[width=2cm]{agree}},%ï¼ˆä¸­æœŸæ£€æŸ¥è¡¨ï¼‰æ•™ç ”å®¤ã€å­¦é™¢æ„è§
  AgreeS    ={\includegraphics[width=2cm]{agree2}},%ï¼ˆä¸­æœŸæ£€æŸ¥è¡¨ï¼‰æ•™ç ”å®¤ã€å­¦é™¢æ„è§
  Gyear       ={\the\year},%ï¼ˆä»»åŠ¡ä¹¦ã€å®ä¹ è®¡åˆ’è¡¨ï¼‰å±Š
  Date        ={\the\year{}å¹´1æœˆ15æ—¥},%ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å°é¢æ—¥æœŸ
  ReviewDate  ={\the\year{}å¹´1æœˆ20æ—¥},%ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰ç­¾å­—æ—¥æœŸ
  TaskDate    ={\arabic{lastyear}å¹´10æœˆ30æ—¥},%ï¼ˆä»»åŠ¡ä¹¦ï¼‰ä»»åŠ¡ä¸‹è¾¾æ—¥æœŸ
  DueDate  ={\the\year{}å¹´5æœˆ15æ—¥},       %ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿåº”é€äº¤æ¯•ä¸šè®ºæ–‡æ—¥æœŸ
  Midchkdate  ={\the\year{}å¹´3æœˆ10æ—¥},%ï¼ˆä¸­æœŸæ£€æŸ¥è¡¨ï¼‰æ—¥æœŸ
  % æŒ‡å¯¼æ•™å¸ˆa
  Advisora       ={ç‹æ™“æ—},            % å§“å
  AdvisoraTitle  ={è®²å¸ˆ},              % èŒç§°
  AdvisoraFrom   ={å¤§æ•°æ®ä¸æ™ºèƒ½å·¥ç¨‹å­¦é™¢}, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰å·¥ä½œå•ä½
  AdvisoraGender ={ç”·},               % æ€§åˆ«  
  AdvisoraAge    ={\arabic{age}},     % å¹´é¾„     
  AdvisoraDegree ={ç¡•å£«},              % å­¦ä½
  AdvisoraSig    ={\includegraphics[width=25mm]{wangxiaolin}}, % æŒ‡å¯¼æ•™å¸ˆaç­¾å
  % æŒ‡å¯¼æ•™å¸ˆb
  Advisorb       =, % å§“å
  AdvisorbTitle  =, % èŒç§°
  AdvisorbFrom   =, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰å·¥ä½œå•ä½
  AdvisorbSig    =, % ç­¾å      
  AdvisorbGender =, % æ€§åˆ«      
  AdvisorbAge    =, % å¹´é¾„      
  AdvisorbDegree =, % å­¦ä½
  % å­¦ç”Ÿ
  Subject       ={è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯},% ä¸“ä¸š
  StudSig ={\includegraphics[width=25mm]{Harry}},% ç­¾å
  School        = {å¤§æ•°æ®ä¸æ™ºèƒ½å·¥ç¨‹å­¦é™¢}, %ï¼ˆå®ä¹ è®¡åˆ’è¡¨ï¼‰å­¦ç”Ÿæ‰€å±å­¦é™¢
  Grade         ={\arabic{grade}çº§ï¼ˆä¸“å‡æœ¬ï¼‰},% å¹´çº§
  %%%%% 
  PrjFrmA/.store in = \SWFU@PrjFrmA, PrjFrmA={â˜}, %ç§‘ç ”é¡¹ç›®
  PrjFrmB/.store in = \SWFU@PrjFrmB, PrjFrmB={â˜}, %ç¤¾ä¼šå®è·µ
  PrjFrmC/.store in = \SWFU@PrjFrmC, PrjFrmC={â˜}, %å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®
  PrjFrmD/.store in = \SWFU@PrjFrmD, PrjFrmD={â˜‘}, %å…¶å®ƒæ¥æº
  PrjTypeA/.store in = \SWFU@PrjTypeA, PrjTypeA={â˜}, %æ¯•ä¸šè®ºæ–‡
  PrjTypeB/.store in = \SWFU@PrjTypeB, PrjTypeB={â˜‘}, %æ¯•ä¸šè®¾è®¡
  PPSLComment/.store in = \SWFU@PPSLComment, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰æŒ‡å¯¼æ•™å¸ˆæ„è§
  PPSLComment={åŒæ„å¼€é¢˜ã€‚},%
  PPSLi/.store in  = \SWFU@PPSLi,  %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰1. è¯¥ç ”ç©¶çš„ç›®çš„ã€æ„ä¹‰
  PPSLii/.store in = \SWFU@PPSLii, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰2. å›½å†…å¤–ç ”ç©¶ç°çŠ¶åŠå‘å±•è¶‹åŠ¿
  BIB/.store in    = \SWFU@BIB,    %ï¼ˆå¼€é¢˜æŠ¥å‘Šã€ä»»åŠ¡ä¹¦ï¼‰å‚è€ƒæ–‡çŒ®
  BIB={%ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰3. ä¸»è¦å‚è€ƒæ–‡çŒ®
    \nocite{*} \printbibliography[heading=none]%
  },%
  PPSLiv/.store in = \SWFU@PPSLiv, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰4. è¯¥ç ”ç©¶çš„ä¸»è¦å†…å®¹ï¼Œé‡ç‚¹è§£å†³çš„é—®é¢˜ï¼Œ
  %                                % é¢„æœŸç»“æœæˆ–æˆæœ
  PPSLv/.store in  = \SWFU@PPSLv,  %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰5. æ‹Ÿé‡‡å–çš„ç ”ç©¶æ–¹æ³•æˆ–å®éªŒæ–¹æ³•ï¼Œæ­¥éª¤ï¼Œ
  %                                % å¯èƒ½å‡ºç°çš„æŠ€æœ¯é—®é¢˜åŠè§£å†³åŠæ³•
  PPSLvi/.store in = \SWFU@PPSLvi, %ï¼ˆå¼€é¢˜æŠ¥å‘Šï¼‰6. å®Œæˆè¯¥ç ”ç©¶å·²å…·å¤‡çš„æ¡ä»¶  
  TSKwhy/.store in  = \SWFU@TSKwhy,  %ï¼ˆä»»åŠ¡ä¹¦ï¼‰é€‰é¢˜çš„ç›®çš„åŠæ„ä¹‰
  TSKwhat/.store in = \SWFU@TSKwhat, %ï¼ˆä»»åŠ¡ä¹¦ï¼‰å­¦ç”Ÿä»»åŠ¡åŠè¦æ±‚
  TSKwhen/.store in = \SWFU@TSKwhen, %ï¼ˆä»»åŠ¡ä¹¦ï¼‰è¿›åº¦å®‰æ’
  TSKwhen={%ï¼ˆä»»åŠ¡ä¹¦ï¼‰ è¿›åº¦ã€å®‰æ’ã€‚ä¸è¦è¶…è¿‡10è¡Œã€‚
    \begin{itemize}
    \item æ¯å‘¨: äº¤ä¸€æ¬¡å‘¨æŠ¥å‘Š
    \item æ¯ä¸¤å‘¨: å¼€ä¼šè®¨è®ºä¸€æ¬¡
    \item 1 -- 4å‘¨: è°ƒç ”ï¼Œå¹¶ç¡®å®šè®ºæ–‡ä¸€çº§ç›®å½•
    \item 5 -- 8å‘¨: æ˜ç¡®è¦å®ç°çš„å†…æ ¸åŠŸèƒ½æ¨¡å—
    \item 8 -- 12å‘¨: ç¼–ç å®ç°ï¼Œå¹¶å®Œæˆè®ºæ–‡çš„ç›¸åº”éƒ¨åˆ†
    \item 12 -- 16å‘¨: æµ‹è¯•ã€å®Œå–„ï¼Œå¹¶å®Œæˆè®ºæ–‡çš„ç›¸åº”éƒ¨åˆ†
    \item 16 -- 20å‘¨: è®ºæ–‡ç»ˆç¨¿
    \end{itemize}},%
  Plan/.store in = \SWFU@Plan, %ï¼ˆå®ä¹ è®¡åˆ’è¡¨ï¼‰è®ºæ–‡å·¥ä½œè®¡åˆ’å’Œé¢„æœŸç›®æ ‡æ‘˜è¦
  PrjDone/.store in       = \SWFU@PrjDone,       %(ä¸­æœŸæ£€æŸ¥è¡¨)ç›®å‰å·²å®Œæˆä»»åŠ¡
  PrjTodo/.store in       = \SWFU@PrjTodo,       %(ä¸­æœŸæ£€æŸ¥è¡¨)å°šéœ€å®Œæˆçš„ä»»åŠ¡
  PrjProblem/.store in    = \SWFU@PrjProblem,    %(ä¸­æœŸæ£€æŸ¥è¡¨)å­˜åœ¨çš„é—®é¢˜å’Œè§£å†³åŠæ³•
  MidchkComment/.store in = \SWFU@MidchkComment, %(ä¸­æœŸæ£€æŸ¥è¡¨)æŒ‡å¯¼æ•™å¸ˆè¯„è¯­
  MidchkComment={è¿›åº¦ç¬¦åˆè¦æ±‚ï¼ŒæŠ“ç´§å®Œæˆè®ºæ–‡ã€‚},%
}

\newrobustcmd{\swfusetup}[1]{\pgfkeys{#1}}

\RequirePackage[%showframe,%showcrop,
top=3cm,bottom=2.5cm,left=3cm,right=2.5cm,
nomarginpar,headheight=15pt, % to avoid "headheight too small"
]{geometry}

\RequirePackage{graphicx}
\graphicspath{{../figs/}{./figs/}{./}{../}} %mind the trailing â€œ/â€

\RequirePackage{caption,subcaption}% \captionof{table|figure}{t|f}

\RequirePackage{tabularray}%tabularx,,longtable,booktabs,makecell,multicol,multirow,array

\RequirePackage{indentfirst,enumitem} % \setlist
\setlist{nosep} % kills all vertical spacing
% \setlist{itemsep=-.5ex}

%%%%% biblatex
\RequirePackage[backend=biber,%
style=gb7714-2015,gbpub=false,gbtype=false,gbpunctin=false,%
url=false,doi=false,isbn=false]{biblatex}

\renewrobustcmd{\bibfont}{\zihao{5}\songti}

% \RequirePackage{wx672tcb} % tcolorbox
\RequirePackage[most]{tcolorbox}
\usetikzlibrary{calc}

\tcbset{%show bounding box,%
  enhanced, breakable, sharp corners, nobeforeafter,%
  colback=white, coltitle=black, colbacktitle=white, colframe=black,%
  bottomrule=.2pt, after skip=-1.5pt,%bottomrule at break=.5pt,
  before upper={\parindent 2em},%
  overlay middle={%
    \draw[line width=.2pt] (frame.north west)--(frame.north east);
    \draw[line width=.2pt] (frame.south west)--(frame.south east);%
  },%
  overlay last={%
    \draw[line width=.2pt] (frame.north west)--(frame.north east);},%
}

% for the proposal part
\newcounter{main}
\newtcolorbox[use counter=main]{mainbodybox}[1]{%
  boxrule=.4pt,titlerule=0pt,%
  fonttitle=\large\bfseries,%
  overlay unbroken and first={%
    \draw[line width=.2pt] (frame.south west)--(frame.south east);%
  },%
  title=\zhnumber{\thetcbcounter}ã€#1}

% for the taskspec part
% #1 - text width;
% #2 - title text.
\newtcolorbox{Titleleft}[2][2em]{% 
  frame hidden, left=40pt,%
  borderline={.4pt}{0pt}{black},% vlines
  borderline west={.4pt}{32pt}{black},% 2nd left vline
  overlay unbroken and first={%
    \node at ($(frame.west)+(16pt,0)$) %
    [anchor=center, text width=#1, font=\bfseries] {#2};%

    \draw[line width=.2pt] (frame.south west)--(frame.south east);% bottom hline
  },%
}

\newtcolorbox{titleleft}[1]{% 
  frame hidden, left=24pt,%
  borderline={.4pt}{0pt}{black},% vlines
  borderline west={.4pt}{18pt}{black},% 2nd left vline
  overlay unbroken and first={%
    \node at (frame.west) [anchor=west, text width=1em,%
    execute at begin node=\setlength{\baselineskip}{3pt}]%
    {#1};%

    \draw[line width=.2pt] (frame.south west)--(frame.south east);% bottom hline
  },%
}

% \singlespacing, \onehalfspacing, \doublespacing
\RequirePackage[doublespacing]{setspace}
\renewrobustcmd\doublespacing{\setstretch{1.6}}
% \renewrobustcmd\singlespacing{\setstretch{1.2}}

\setlength{\parindent}{2em}

\pagestyle{plain}

\newrobustcmd{\PPSLtitlepage}{% Proposal title page
  \thispagestyle{empty}
  \begin{center}
    \makebox[14em][s]{\LARGE\heiti è¥¿å—æ—ä¸šå¤§å­¦}\\[5mm]
    \makebox[28em][s]{\LARGE\heiti æœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å¼€é¢˜æŠ¥å‘Š}\\[5mm]
    \vskip 3cm
    \begin{large}
      \begin{minipage}{1.0\linewidth}
        \begin{tblr}{width=\textwidth, colspec={@{}rX@{}}}
          \makebox[7em][s]{è®ºæ–‡ï¼ˆè®¾è®¡ï¼‰é¢˜ç›®}%
          &\makebox[0pt][t]{%
            \begin{minipage}[t]{30em}
              \begin{center}
                \parbox[t]{29em}{\centering\bfseries\Large\SWFU@Prjtitle}
              \end{center}
            \end{minipage}}%
          \rule[-1.5ex]{30em}{.1pt}\par%
          \rule[-1.5ex]{30em}{.1pt}\\%
        \end{tblr}
      \end{minipage}
      \vskip 2cm
      \begin{minipage}{.8\linewidth}
        \begin{center}
          \begin{tblr}{%
              colspec={@{}rX[c]@{}},%
              rows={12mm,belowsep=-1pt},hline{2-Z}={2}{solid}}
            \makebox[7em][s]{ä¸“ä¸šåç§°}%
            & \SWFU@Subject\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å¹´çº§}%
            & \SWFU@Grade\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å­¦ç”Ÿå§“å}%
            & \SWFU@Studname\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å­¦ç”Ÿå­¦å·}%
            & \SWFU@Studid\\[-1ex]\cline{2-2}
            \makebox[7em][s]{æŒ‡å¯¼æ•™å¸ˆ (èŒç§°)}%
            & \SWFU@Advisora{}ï¼ˆ\SWFU@AdvisoraTitleï¼‰\\[-1ex]\cline{2-2}
            & \SWFU@Advisorb{} \SWFU@AdvisorbTitle\\[-1ex]\cline{2-2}
            \makebox[7em][s]{å¡«è¡¨æ—¶é—´}%
            & \SWFU@Date{}\\[-1ex]\cline{2-2}
          \end{tblr}
        \end{center}
      \end{minipage}
    \end{large}
    \vfill
    {\heiti è¥¿å—æ—ä¸šå¤§å­¦æ•™åŠ¡å¤„åˆ¶}\\[1cm]
  \end{center}
  \clearpage}

\newrobustcmd{\PPSLinstructionpage}{% Proposal instruction page
  \begin{center}
    \LARGE\bfseries\makebox[7em][s]{å¡«è¡¨è¯´æ˜}
  \end{center}
  \vskip 5ex
  \begin{itemize}
  \item[ä¸€ã€] å¼€é¢˜æŠ¥å‘Šå„é¡¹å†…å®¹è¦å®äº‹æ±‚æ˜¯ï¼Œé€æ¡è®¤çœŸå¡«å†™ï¼Œè¡¨è¾¾è¦æ˜ç¡®ã€ä¸¥è°¨ã€‚å¤–æ¥è¯­åº”ç”¨ä¸­æ–‡å’Œ
    è‹±æ–‡åŒæ—¶è¡¨è¾¾ï¼Œç¬¬ä¸€æ¬¡å‡ºç°çš„ç¼©å†™è¯ï¼Œé¡»æ³¨å‡ºå…¨ç§°ã€‚
  \item[äºŒã€] å¼€é¢˜æŠ¥å‘Šéœ€ç”¨è®¡ç®—æœºæ‰“å°ï¼Œä¸€å¾‹ä¸º A4 å¼€æœ¬ï¼Œäºå·¦ä¾§è£…è®¢æˆå†Œã€‚å„æ ç©ºæ ¼ä¸å¤Ÿæ—¶ï¼Œè¯·è‡ª
    è¡ŒåŠ é¡µã€‚
  \item[ä¸‰ã€] å¼€é¢˜æŠ¥å‘Šéœ€åœ¨ç¬¬å…«å­¦æœŸå¼€å­¦ä¹‹å‰å®Œæˆã€‚
  \item[å››ã€] å¼€é¢˜æŠ¥å‘Šéœ€è£…å…¥è¥¿å—æ—ä¸šå¤§å­¦æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰æ¡£æ¡ˆè¢‹ã€‚
  \end{itemize}
  \clearpage}

\newrobustcmd{\PPSLmain}{% main part
  \begin{singlespace}
    \noindent
    \begin{tblr}{width=\linewidth,%
        colspec={|c|c|c|c|c|c|X[c]|},%
        rowspec={Q[m]|Q|Q|Q[m]} }%
      \hline \SetCell[r=3]{m,2em}{æŒ‡å¯¼\\æ•™å¸ˆ\\åŸºæœ¬\\æƒ…å†µ} & æŒ‡å¯¼æ•™å¸ˆå§“å & {æ€§\\åˆ«} &%
      {å¹´\\é¾„} & {å­¦å†æˆ–\\å­¦ä½} & {ä¸“ä¸šæŠ€æœ¯\\èŒåŠ¡æˆ–èŒç§°} &å·¥ä½œå•ä½\\
      & \SWFU@Advisora & \SWFU@AdvisoraGender & \SWFU@AdvisoraAge &%
      \SWFU@AdvisoraDegree & \SWFU@AdvisoraTitle & \SWFU@AdvisoraFrom\\
      \SWFU@Advisorb & \SWFU@AdvisorbGender & \SWFU@AdvisorbAge &%
      \SWFU@AdvisorbDegree & \SWFU@AdvisorbTitle & \SWFU@AdvisorbFrom\\
      {è¯¾é¢˜\\æ¥æº} & \SetCell[c=6]{m} %
      \qquad\SWFU@PrjFrmA{}ç§‘ç ”é¡¹ç›®%
      \qquad\SWFU@PrjFrmB{}ç¤¾ä¼šå®è·µ%
      \qquad\SWFU@PrjFrmC{}å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®%
      \qquad\SWFU@PrjFrmD{}å…¶å®ƒæ¥æº\\%
    \end{tblr}
  \end{singlespace}
  \vskip -2pt
  \begin{mainbodybox}{è¯¥ç ”ç©¶çš„ç›®çš„ã€æ„ä¹‰}
    \SWFU@PPSLi{}
  \end{mainbodybox}
  \begin{mainbodybox}{å›½å†…å¤–ç ”ç©¶ç°çŠ¶åŠå‘å±•è¶‹åŠ¿}
    \SWFU@PPSLii{}
  \end{mainbodybox}
  \begin{mainbodybox}{ä¸»è¦å‚è€ƒæ–‡çŒ®}
    \SWFU@BIB{}
  \end{mainbodybox}
  \begin{mainbodybox}{è¯¥ç ”ç©¶çš„ä¸»è¦å†…å®¹ï¼Œé‡ç‚¹è§£å†³çš„é—®é¢˜ï¼Œé¢„æœŸç»“æœæˆ–æˆæœ}
    \SWFU@PPSLiv{}
  \end{mainbodybox}
  \begin{mainbodybox}{æ‹Ÿé‡‡å–çš„ç ”ç©¶æ–¹æ³•æˆ–å®éªŒæ–¹æ³•ï¼Œæ­¥éª¤ï¼Œå¯èƒ½å‡ºç°çš„æŠ€æœ¯é—®é¢˜åŠè§£å†³åŠæ³•}
    \SWFU@PPSLv{}
  \end{mainbodybox}
  \begin{mainbodybox}{å®Œæˆè¯¥ç ”ç©¶å·²å…·å¤‡çš„æ¡ä»¶}
    \SWFU@PPSLvi{}
  \end{mainbodybox}
  \begin{mainbodybox}{æŒ‡å¯¼æ•™å¸ˆæ„è§}
    \bigskip
    \SWFU@PPSLComment\par
    \hfill ç­¾åï¼š\qquad\SWFU@AdvisoraSig\par\medskip%
    \hfill\SWFU@Date
  \end{mainbodybox}
  \noindent
  \begin{tcolorbox}[sharp corners,nobeforeafter,%
    left=0pt,right=0pt,top=-13pt,bottom=0pt,boxsep=0pt,%
    colback=white, boxrule=.5pt]
    \singlespacing\noindent
    \begin{tblr}{width=\linewidth,rows={m},%%
        colspec={c|X|c|X},%        
      }
      {æ•™\\ç ”\\å®¤\\æ„\\è§} &%
      \begin{minipage}[c][3.5cm]{\linewidth}
        æ•™ç ”å®¤è´Ÿè´£äººï¼š\par\vfill%
        \hfill\SWFU@DeptSig\par\medskip%
        \hfill\SWFU@ReviewDate%
      \end{minipage} &%
      {æ•™\\å­¦\\é™¢\\ç³»\\éƒ¨\\æ„\\è§} &%
      \begin{minipage}[c][3.5cm]{\linewidth}
        æ•™å­¦é™¢ç³»éƒ¨è´Ÿè´£äººï¼š\par\vfill%
        \hfill\SWFU@SchoolSig\par\medskip%
        \hfill\SWFU@ReviewDate%
      \end{minipage}\\
    \end{tblr}    
  \end{tcolorbox}%
}

\newrobustcmd{\maketaskspec}{%
  \pagestyle{empty}
  {\centering%\singlespacing%
    {\heiti\Large è¥¿å—æ—ä¸šå¤§å­¦\SWFU@Gyear{}å±Šæœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰ä»»åŠ¡
      ä¹¦}\\[3ex]%
    \begin{singlespace}
      \begin{tblr}{width=\linewidth, vlines,hline{1,2,3},%
          colspec={cXcccX}, rowspec={Q[m]Q[m]Q[m]},%
          column{odd}={font=\bfseries},% column{even}={font=\kaishu},%
          cell{1}{2}={c=5}{c},%
          cell{3}{4}={c=3}{c},%
        }%
        {è®ºæ–‡ï¼ˆè®¾è®¡ï¼‰\\é¢˜ç›®} & {\SWFU@Prjtitle}\\
        å­¦ç”Ÿå§“å & \SWFU@Studname & å­¦å· & \SWFU@Studid & ä¸“ä¸š & \SWFU@Subject\\
        é¢˜ç›®æ¥æº & {\SWFU@PrjFrmA{}ç§‘ç ”é¡¹ç›®\\\SWFU@PrjFrmB{}ç¤¾ä¼šå®è·µ\\
          \SWFU@PrjFrmC{}å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®\\\SWFU@PrjFrmD{}å…¶å®ƒ} &%
        {é¢˜ç›®\\ç±»åˆ«} &%
        {\SWFU@PrjTypeA{}æ¯•ä¸šè®ºæ–‡\qquad{}\SWFU@PrjTypeB{}æ¯•ä¸šè®¾è®¡}\\
      \end{tblr}\\\vspace*{-1pt}%
    \end{singlespace}
    \begin{titleleft}{é€‰é¢˜çš„ç›®çš„åŠæ„ä¹‰}
      \SWFU@TSKwhy
    \end{titleleft}
    \begin{titleleft}{å­¦ç”Ÿä»»åŠ¡åŠè¦æ±‚}
      \SWFU@TSKwhat
    \end{titleleft}
    \begin{titleleft}{è¿›åº¦å®‰æ’}
      \SWFU@TSKwhen
    \end{titleleft}
    \begin{titleleft}{å‚è€ƒæ–‡çŒ®}
      \SWFU@BIB
    \end{titleleft}
    \noindent
    \begin{tcolorbox}[sharp corners,nobeforeafter,%
      left=0pt,right=0pt,top=-13pt,bottom=0pt,boxsep=0pt,%
      colback=white, boxrule=.5pt]
      \singlespacing\noindent%
      \begin{tblr}{width=\linewidth, colspec={cX[c]cX[c]},%
          vline{2,3,4}={solid}, rows={m},%
        }%
        ä»»åŠ¡ä¸‹è¾¾æ—¥æœŸ & \SWFU@TaskDate &%
        {å­¦ç”Ÿåº”é€äº¤æ¯•ä¸šè®ºæ–‡\\ï¼ˆè®¾è®¡ï¼‰æ—¥æœŸ} & \SWFU@DueDate\\
      \end{tblr}%
    \end{tcolorbox}\\[-3pt]
    \noindent%
    \begin{tcolorbox}[sharp corners,nobeforeafter,%
      left=0pt,right=0pt,top=-13pt,bottom=0pt,boxsep=0pt,%
      colback=white, boxrule=.5pt]
      \singlespacing\noindent
      \begin{tblr}{width=\linewidth, colspec={cXcX},%
          rows={m}, hline{2}={solid}, vline{2-4}={solid},%
        }%
        {æŒ‡å¯¼æ•™å¸ˆ\\ç­¾å­—} &%
        \begin{minipage}[c][25mm]{\linewidth}%
          \begin{center}
            \makebox[0pt][c]{\SWFU@AdvisoraSig}
          \end{center}
          \vfill%
          \hfill\SWFU@ReviewDate{}%
        \end{minipage} &%
        {æ¥å—ä»»åŠ¡\\å­¦ç”Ÿç­¾å­—} &%
        \begin{minipage}[c][25mm]{\linewidth}%
          \begin{center}
            \makebox[0pt][c]{\SWFU@StudSig}
          \end{center}
          \vfill%
          \hfill\SWFU@Date%
        \end{minipage}\\%
        {æ•™ç ”å®¤\\å®¡æ ¸} &%
        \begin{minipage}[c][35mm]{\linewidth}%
          å®¡æ ¸æ„è§ï¼š\par\vfill%
          \hfill{}ç­¾å­—ï¼š\quad\SWFU@DeptSig\par\medskip%
          \hfill\SWFU@ReviewDate%
        \end{minipage} &%
        {å­¦é™¢å®¡æ ¸} &%
        \begin{minipage}[c][35mm]{\linewidth}%
          å®¡æ ¸æ„è§ï¼š\par\vfill%
          \hfill{}ç­¾ç« ï¼š\quad\SWFU@SchoolSig\par%
          \hfill\SWFU@ReviewDate%
        \end{minipage}\\
      \end{tblr}\\
    \end{tcolorbox}
    \begin{tblr}{width=\linewidth, colspec={@{}c@{\;}X@{}}} 
      æ³¨ï¼š&%
      {1. æ­¤ä»»åŠ¡ä¹¦ç”±æŒ‡å¯¼æ•™å¸ˆå¡«å†™ï¼Œå„é™¢å®¡å®šï¼Œåœ¨æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å¼€å§‹å‰ä¸€å‘¨å†…å¡«å¥½å¹¶å‘ç»™å­¦ç”Ÿã€‚\\
        2. æ­¤ä»»åŠ¡ä¹¦åŒé¢æ‰“å°ï¼Œä¸€å¼ä¸¤ä»½ã€‚å­¦ç”Ÿä¸€ä»½ï¼Œå¦ä¸€ä»½éšæ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰ä¿å­˜ã€‚}\\
    \end{tblr}}}

\newrobustcmd\makeplan{%
  \thispagestyle{empty}
  % \singlespacing
  {\centering\heiti\Large è¥¿å—æ—ä¸šå¤§å­¦\SWFU@Gyear{}å±Šæœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰å®ä¹ è®¡åˆ’è¡¨\par}
  \bigskip
  \hfillï¼ˆæœ¬è¡¨ç”±æ¯•ä¸šç”Ÿå¡«å†™ï¼‰\par\vspace*{-7pt}
  {\centering
    \begin{singlespace}
      \begin{tblr}{width=\linewidth,
          colspec={|X[-1,c,font=\bfseries]|X[c]|}, rowspec={|Q|Q|}%,font=\kaishu
        }%
        è®ºæ–‡ï¼ˆè®¾è®¡ï¼‰é¢˜ç›®&\SWFU@Prjtitle\\
      \end{tblr}
      \vskip -1pt
      \begin{tblr}{width=\linewidth, colspec={|c|X[c]|c|l|}, rowspec={Q[m]|},        
          column{odd}={font=\bfseries}}%, column{even}={font=\kaishu}
        {é¢˜ç›®\\ç±»åˆ«} & \SWFU@PrjTypeA{}æ¯•ä¸šè®ºæ–‡\qquad\SWFU@PrjTypeB{}æ¯•ä¸šè®¾è®¡ &%
        {é¢˜ç›®\\æ¥æº} & {\SWFU@PrjFrmA{}ç§‘ç ”é¡¹ç›®\quad\SWFU@PrjFrmB{}ç¤¾ä¼šå®è·µ\quad%
          \SWFU@PrjFrmD{}å…¶å®ƒæ¥æº\\\SWFU@PrjFrmC{}å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šé¡¹ç›®}\\
      \end{tblr}
      \vskip -1pt
      \begin{tblr}{width=\linewidth,%
          colspec={|r|X[c]|r|X[c]|}, rowspec={Q[m]|Q[m]|},%
          column{odd}={font=\bfseries}}% , column{even}={font=\kaishu}
        æŒ‡å¯¼æ•™å¸ˆ&\SWFU@Advisora&èŒç§°&\SWFU@AdvisoraTitle\\
        è¾…åŠ©æŒ‡å¯¼æ•™å¸ˆ&\SWFU@Advisorb&èŒç§°&\SWFU@AdvisorbTitle\\
      \end{tblr}
      \vskip -1pt
      \begin{tblr}{width=\linewidth,%
          colspec={|c|X[-1,c]|c|X|c|X[-1,c]|}, column{odd}={font=\bfseries},
          rowspec={Q[m]|Q[m]|Q[m]|Q[m]|Q[m]|Q[m]|}
        }%
        å­¦ç”Ÿå§“å&\SWFU@Studname&ä¸“ä¸š&\SWFU@Subject&å­¦å·&\SWFU@Studid\\
        æ‰€å±å­¦é™¢&\SetCell[c=5]{m}\SWFU@School\\
      \end{tblr}
    \end{singlespace}
    \vskip -1pt
    \begin{tblr}{width=\linewidth, colspec={|X|},rowspec={Q[m]Q[m]|}}
      è®ºæ–‡å·¥ä½œè®¡åˆ’å’Œé¢„æœŸç›®æ ‡æ‘˜è¦ï¼š\\
      \begin{minipage}[t][12cm]{1.0\linewidth}
        \qquad{}\SWFU@Plan
      \end{minipage}\\
    \end{tblr}\par%
    {\heiti æ³¨ï¼š}æ¯ä½æ¯•ä¸šç”Ÿé¡»å¡«å†™ä¸€ä»½ï¼›å¦‚è¡¨æ ä¸å¤Ÿå¡«å†™ï¼Œè¯·åŠ é™„é¡µã€‚}\clearpage}

\newrobustcmd{\makeproposal}{%
  \PPSLtitlepage{}
  \PPSLinstructionpage{}
  \PPSLmain{}}

\newrobustcmd\midchk{\pagestyle{empty}%
  {\centering\Large\heiti è¥¿å—æ—ä¸šå¤§å­¦æœ¬ç§‘æ¯•ä¸šè®ºæ–‡ï¼ˆè®¾è®¡ï¼‰ä¸­æœŸæ£€æŸ¥è¡¨\par}
  \singlespacing\medskip\noindent%  
  \begin{tblr}{width=\linewidth,colspec={cX[c]cX[c]},hline{1-7},vlines,%
      cell{3-5}{2}={c=3}{c}, cell{7}{1}={c=4}{c},%
      cell{6}{2}={c=3}{l}}
    å­¦ç”Ÿå§“å&\SWFU@Studname&å­¦ç”Ÿå­¦å·&\SWFU@Studid\\
    ä¸“\quad{}ä¸š&\SWFU@Subject&æŒ‡å¯¼æ•™å¸ˆ&\SWFU@Advisora\\
    è®ºæ–‡é¢˜ç›® &{\SWFU@Prjtitle}&&\\
    {ç›®å‰å·²å®Œ\\æˆä»»åŠ¡} & %
    \begin{tblr}{width=.85\textwidth,colspec={X},row{1}={2cm}{t},row{2}={f}}
      \SWFU@PrjDone\\
      \hfill{}æ˜¯å¦ç¬¦åˆè®¡åˆ’è¿›åº¦ï¼Ÿ\qquad{}â˜‘æ˜¯\quad{}â˜å¦\\
    \end{tblr} &&\\
    {å°šéœ€å®Œæˆ\\çš„ä»»åŠ¡} & %
    \begin{tblr}{width=.85\textwidth,colspec={X},row{1}={2cm}{t},row{2}={f}}
      \SWFU@PrjTodo\\
      \hfill{}èƒ½å¦æŒ‰æœŸå®Œæˆä»»åŠ¡ï¼Ÿ\qquad{}â˜‘æ˜¯\quad{}â˜å¦\\
    \end{tblr} &&\\
    {å­˜åœ¨çš„é—®\\é¢˜å’Œè§£å†³\\åŠæ³•} & %
    \begin{tblr}{width=.85\textwidth,colspec={X},row{1}={2cm}{t}}
      \SWFU@PrjProblem\\
    \end{tblr} &&\\% 
    \mbox{ï¼ˆä»¥ä¸Šéƒ¨åˆ†ç”±å­¦ç”Ÿå¡«å†™ï¼‰}&&&\\
  \end{tblr}\vspace{-1pt}
  \begin{titleleft}{æŒ‡å¯¼æ•™å¸ˆè¯„è¯­}
    \SWFU@MidchkComment\par\bigskip%
    \hfill{}æŒ‡å¯¼æ•™å¸ˆï¼ˆç­¾åï¼‰ï¼š\makebox[3cm][c]{\SWFU@AdvisoraSig}\par\medskip%
    \hfill{}\SWFU@Midchkdate%
  \end{titleleft}
  \noindent%
  \begin{tblr}{width=\linewidth,colspec={lccX[c]},hline{2-Z},vlines,%
      cell{1}{1}={c=4}{c}, cell{8}{1,3}={c=2}{c}, cell{2}{1}={c},%
    }
    \mbox{ï¼ˆä»¥ä¸‹éƒ¨åˆ†ç”±æ•™å­¦é™¢ã€ç³»ã€éƒ¨å¡«å†™ï¼‰}&&&\\
    {è¯„\, åˆ†\, é¡¹\, ç›®} &æœ€é«˜åˆ†å€¼&è¯„åˆ†&å¤‡\, æ³¨\\
    æŒ‡å¯¼æ•™å¸ˆå¯¹æ¯•ä¸šå®ä¹ çš„æŒ‡å¯¼åŠ›åº¦&25&&\\
    æ¯•ä¸šè®ºæ–‡çš„å®éªŒæ¡ä»¶&15&&\\
    æ¯•ä¸šè®ºæ–‡çš„é€‚åˆåº¦&20&&\\
    å®Œæˆè®ºæ–‡çš„è¿›åº¦&15&&\\
    å­¦ç”Ÿè¡¨ç°&25&&\\
    æ€»\qquad{}åˆ†&&&\\
  \end{tblr}
  \vskip -1.5pt\noindent%
  \begin{tblr}{width=\linewidth,colspec={cXcX},vlines,hline{2-Z},%
      column{1,3}={5mm,m},%
    }
    {æ•™ç ”å®¤æ„è§} & %
    \begin{minipage}[c][35mm]{\linewidth}
      \makebox[4cm][r]{\SWFU@AgreeD}\\\bigskip%
      æ•™ç ”å®¤è´Ÿè´£äººï¼š\hfill\makebox[3cm][r]{\SWFU@DeptSig}\par%
      \hfill\SWFU@Midchkdate%
    \end{minipage} & %
    {å­¦é™¢æ„è§} & %
    \begin{minipage}[c][35mm]{\linewidth}
      \makebox[4cm][r]{\SWFU@AgreeS}\\\bigskip%
      å­¦é™¢è´Ÿè´£äººï¼š\hfill\makebox[3cm][r]{\SWFU@SchoolSig}\par%
      \hfill\SWFU@Midchkdate
    \end{minipage}\\
  \end{tblr}}
