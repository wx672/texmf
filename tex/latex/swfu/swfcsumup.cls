% è¥¿å—æ—ä¸šå¤§å­¦è¯¾ç¨‹æ•™å­¦å°ç»“è¡¨
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{swfcsumup}

\LoadClass[scheme=plain]{ctexart}

\RequirePackage{ifxetex} % XeTeX only

\RequirePackage{calc,ifthen}
\RequirePackage{tabu,array}
\RequirePackage{graphicx}

\RequirePackage[% showframe,
paperwidth=195mm, paperheight=270mm,
top=2cm, bottom=2cm,
left=2.5cm, right=2.5cm,
]{geometry}

\RequirePackage{tikz}
\usetikzlibrary{backgrounds,positioning,fit}
                
\newcommand{\Term}[1]{\gdef\SWFCField@Term{#1}} % æˆè¯¾å­¦æœŸ
\newcommand{\Coursetitle}[1]{\gdef\SWFCField@Coursetitle{\kaishu #1}} % è¯¾ç¨‹åç§°
\newcommand{\Totaltime}[1]{\gdef\SWFCField@Totaltime{#1}} % æ€»å­¦æ—¶
\newcommand{\Labtime}[1]{\gdef\SWFCField@Labtime{#1}} % å®éªŒå­¦æ—¶
\newcommand{\Practicetime}[1]{\gdef\SWFCField@Practicetime{#1}} % å®ä¹ å¤©æ•°
\newcommand{\School}[1]{\gdef\SWFCField@School{\kaishu #1}} % å¼€è¯¾é™¢ç³»
\newcommand{\Class}[1]{\gdef\SWFCField@Class{\kaishu #1}} % æˆè¯¾ç­çº§
\newcommand{\Studnum}[1]{\gdef\SWFCField@Studnum{#1}} % å­¦ç”Ÿäººæ•°
\newcommand{\Multimedia}[1]{\gdef\SWFCField@Multimedia{\kaishu #1}} % å¤šåª’ä½“æ•™å­¦
\newcommand{\Bilingual}[1]{\gdef\SWFCField@Bilingual{\kaishu #1}} % åŒè¯­æ•™å­¦
\newcommand{\Examtype}[1]{\gdef\SWFCField@Examtype{\kaishu #1}} % è€ƒæ ¸æ–¹å¼
\newcommand{\Textbook}[1]{\gdef\SWFCField@Textbook{#1}} % æ‰€ç”¨æ•™æ
\newcommand{\Publishtime}[1]{\gdef\SWFCField@Publishtime{#1}} % å‡ºç‰ˆæ—¶é—´
\newcommand{\Sumup}[1]{\gdef\SWFCField@Sumup{\kaishu #1}} % è¯¾ç¨‹æ•™å­¦æ€»ç»“
\newcommand{\Suggestion}[1]{\gdef\SWFCField@Suggestion{\kaishu #1}} % ä»Šåæ”¹é©è®¾æƒ³
\newcommand{\TeacherName}[1]{\gdef\SWFCField@TeacherName{\kaishu #1}} % æ•™å¸ˆå§“å
\newcommand{\TeacherTitle}[1]{\gdef\SWFCField@TeacherTitle{\kaishu #1}} % èŒç§°
\newcommand{\Date}[1]{\gdef\SWFCField@Date{\kaishu #1}}

\newcommand{\Signit}[3]{%\Signit{-3cm}{-6.2cm}{../signature}
\begin{tikzpicture}[overlay,remember picture]%
  \node [xshift=#1,yshift=#2] at (current page.center) {%
    \includegraphics[scale=.1]{#3}%
  };%
\end{tikzpicture}}

\newfontfamily\dejavu{DejaVu Sans Mono}
\newcommand\unchecked{\dejavu â–¡}%ballot box
\newcommand\checked{\large\dejavu â˜‘} %ğŸ—¹

\newcommand{\YES}{{\Large\checked}æ˜¯\quad\unchecked{}å¦}
\newcommand{\NO}{\unchecked{}æ˜¯\quad{\Large\checked}å¦}

\newcommand{\makeform}{
  {\centering
    {\LARGE\heiti è¥¿å—æ—ä¸šå¤§å­¦è¯¾ç¨‹æ•™å­¦å°ç»“è¡¨}\\[2ex]
    \tabulinesep=2mm
    \begin{tabu}{|c|c|c|c|c|X[c]|}
      \tabucline-
      æˆè¯¾å­¦æœŸ&\SWFCField@Term{}&è¯¾ç¨‹åç§°&\multicolumn{3}{c|}{\SWFCField@Coursetitle{}}\\\tabucline-
      æ€»\hspace{.5em}å­¦\hspace{.5em}æ—¶&\SWFCField@Totaltime{}&å®éªŒå­¦æ—¶&\SWFCField@Labtime{}&
      å®ä¹ å¤©æ•°&\SWFCField@Practicetime{}{\kaishu å‘¨}\\\tabucline-
      å¼€è¯¾é™¢ç³»&\SWFCField@School{}&æˆè¯¾ç­çº§&\SWFCField@Class{}&
      å­¦ç”Ÿäººæ•°&\SWFCField@Studnum{}{\kaishu äºº}\\\tabucline-
      å¤šåª’ä½“æ•™å­¦&\SWFCField@Multimedia{}&åŒè¯­æ•™å­¦&\SWFCField@Bilingual{}&
      è€ƒæ ¸æ–¹å¼&\SWFCField@Examtype{}\\\tabucline-
      æ‰€ç”¨æ•™æ&\multicolumn{3}{c|}{\SWFCField@Textbook{}}&
      å‡ºç‰ˆæ—¶é—´&\SWFCField@Publishtime{}\\\tabucline-
    \end{tabu}
    \vspace{-1pt} \tabulinesep=0pt
    \begin{tabu}{|X[.1,c]|X|}
      è¯¾ç¨‹\par\vspace{4ex}æ•™å­¦\par\vspace{4ex}æ€»ç»“\par\vspace{1cm}&
      \begin{minipage}{\columnwidth}
        \vspace*{3ex}
        \SWFCField@Sumup{}
      \end{minipage}\\\tabucline-%
      \vspace{1cm}ä»Šå\par\vspace{4ex}æ”¹é©\par\vspace{4ex}è®¾æƒ³\par\vspace{3cm}&
      \begin{minipage}{.7\columnwidth}
        \vspace{3ex}
        \SWFCField@Suggestion{}
      \end{minipage}\\\tabucline-
      å¡«æŠ¥äºº&\tabulinesep=2mm
      \begin{tabu}{X[c]|c|X[c]}%\SWFCField@TeacherName{}
        &èŒç§°&\SWFCField@TeacherTitle{}\\
      \end{tabu}\\\tabucline-
    \end{tabu}
    \vspace{-1pt} \tabulinesep=2mm
    \begin{tabu}{|X|}
      å¡«æŠ¥æ—¥æœŸï¼š\quad\SWFCField@Date\hfill{}ï¼ˆä»¥ä¸Šä¸ºæˆè¯¾æ•™å¸ˆå¡«å†™ï¼‰\\\tabucline-
      æ•™ç ”å®¤è´Ÿè´£äººå®¡é˜…æ„è§ï¼š\\[5ex]
      \hfill{}\makebox[10em][l]{ç­¾åï¼š}
      \makebox[5em][r]{å¹´}\makebox[3em][r]{æœˆ}\makebox[3em][r]{æ—¥}\\\tabucline-
    \end{tabu}
    æ³¨ï¼šæœ¬è¡¨å¤åˆ¶æœ‰æ•ˆ}}

\Sumup{% è¯¾ç¨‹æ•™å­¦å°ç»“
  \begin{itemize}
  \item
  \item
  \item
  \end{itemize}
}  
\Suggestion{% ä»Šåæ”¹é©è®¾æƒ³
  \begin{itemize}
  \item
  \item
  \item
  \end{itemize}
}

\setlength{\parindent}{2em}

\Term{}\Coursetitle{}
\Totaltime{}\Labtime{}\Practicetime{}
\Class{}\Studnum{}
\Textbook{}\Publishtime{}
\TeacherName{}\TeacherTitle{è®²å¸ˆ}
\School{å¤§æ•°æ®ä¸æ™ºèƒ½å·¥ç¨‹å­¦é™¢}
\Multimedia{\YES}\Bilingual{\YES}\Examtype{å¼€å·æœºè¯•}

\pagestyle{empty}