% è¥¿å—æ—ä¸šå¤§å­¦è¯¾ç¨‹æ•™å­¦å°ç»“è¡¨
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{swfusumup}

\RequirePackage{pgfkeys}

\pgfkeys{%
  Term/.store in   = \SWFU@Term,  %æˆè¯¾å­¦æœŸ
  Course/.store in = \SWFU@Course,%è¯¾ç¨‹åç§°
  Totalhours/.store in = \SWFU@Totalhours,%æ€»å­¦æ—¶
  Labhours/.store in   = \SWFU@Labhours,  %å®éªŒå­¦æ—¶
  Labweek/.store in    = \SWFU@Labweek,   %å®ä¹ å¤©æ•°
  Class/.store in     = \SWFU@Class,    %æˆè¯¾ç­çº§
  Studtotal/.store in = \SWFU@Studtotal,%å­¦ç”Ÿäººæ•°
  Examtype/.store in  = \SWFU@Examtype,%
  Textbook/.store in  = \SWFU@Textbook,%
  Sumup/.store in     = \SWFU@Sumup,%
  Suggestion/.store in   = \SWFU@Suggestion,%
  Date/.store in         = \SWFU@Date, Date={\today},%
  School/.store in       = \SWFU@School,       School       = å¤§æ•°æ®ä¸æ™ºèƒ½å·¥ç¨‹å­¦é™¢,%
  TeacherName/.store in  = \SWFU@TeacherName,  TeacherName  = ç‹æ™“æ—,%
  TeacherTitle/.store in = \SWFU@TeacherTitle, TeacherTitle = è®²å¸ˆ,%
  Multimedia/.store in   = \SWFU@Multimedia,   Multimedia   = \YES,%
  Bilingual/.store in    = \SWFU@Bilingual,    Bilingual    = \YES,%
}
\newcommand{\swfusetup}[1]{\pgfkeys{#1}}

\DeclareOption*{\PassOptionsToClass{\CurrentOption}{article}}%
\ProcessOptions\relax

\LoadClass{article}%

\RequirePackage{wx672babel}

\RequirePackage[backend=biber,url=false,doi=false,isbn=false]{biblatex}

\RequirePackage[%showframe,%
a4paper,nomarginpar,%
vmargin=2cm,%
hmargin=2.5cm,%
]{geometry}

\RequirePackage{wx672tcb}
\usetikzlibrary{backgrounds,positioning,fit}

\RequirePackage{newunicodechar}
\newfontfamily\symbola{Symbola Nerd Font}
\newunicodechar{â˜}{{\symbola â˜}}%ballot box ğŸ—†
\newunicodechar{â˜‘}{{\symbola â˜‘}}%checked box tick ğŸ—¹
\newcommand{\YES}{â˜‘æ˜¯\quad â˜å¦}

\RequirePackage{tabularray}

\newcommand{\makeform}{
  {\centering%
    {\LARGE\heifamily è¥¿å—æ—ä¸šå¤§å­¦è¯¾ç¨‹æ•™å­¦å°ç»“è¡¨}\\\bigskip%
    \begin{tblr}{colspec={cX[c]cX[-1,c]cc}, hlines, vlines,%
        rowsep={5pt},%
        column{even}={font=\kaifamily},%
        cell{1}{4}={c=3}{},cell{5}{2}={c=5}{l,m},%row{3}={m}, 
      }
      æˆè¯¾å­¦æœŸ&\SWFU@Term&è¯¾ç¨‹åç§°&\SWFU@Course\\
      \makebox[4em][s]{æ€»å­¦æ—¶}&\SWFU@Totalhours&%
      å®éªŒå­¦æ—¶&\SWFU@Labhours&å®ä¹ å¤©æ•°&\SWFU@Labweek\\
      å¼€è¯¾é™¢ç³»&\SWFU@School&æˆè¯¾ç­çº§&{\SWFU@Class}&%
      å­¦ç”Ÿäººæ•°&\SWFU@Studtotal\\
      å¤šåª’ä½“æ•™å­¦&\SWFU@Multimedia&åŒè¯­æ•™å­¦&\SWFU@Bilingual&%
      è€ƒæ ¸æ–¹å¼&\SWFU@Examtype\\
      æ‰€ç”¨æ•™æ&%
      \begin{minipage}{.8\linewidth}
        \SWFU@Textbook
      \end{minipage}\\
    \end{tblr}%\\[-1pt]
    \vspace*{-1.2pt}
    \begin{titleleft}{è¯¾ç¨‹æ•™å­¦æ€»ç»“}
      \begin{minipage}[c][15em]{.9\linewidth}
        \SWFU@Sumup
      \end{minipage}
    \end{titleleft}
    \begin{titleleft}{ä»Šåæ”¹é©è®¾æƒ³}
      \begin{minipage}[c][12em]{.9\linewidth}
        \SWFU@Suggestion
      \end{minipage}
    \end{titleleft}
    \vspace*{1.2pt}
    \begin{tblr}{colspec={cX[c]cX[c]}, vlines, rowsep={5pt},%
        column{even}={font=\ttfamily}}
      å¡«æŠ¥äºº&\SWFU@TeacherName&èŒç§°&\SWFU@TeacherTitle\\
    \end{tblr}\\[-1pt]
    \begin{tblr}{colspec={X},vlines, hline{1,2,4}, rowsep={5pt}}
      å¡«æŠ¥æ—¥æœŸï¼š\quad{\ttfamily\SWFU@Date}\hfill{}ï¼ˆä»¥ä¸Šä¸ºæˆè¯¾æ•™å¸ˆå¡«å†™ï¼‰\\
      æ•™ç ”å®¤è´Ÿè´£äººå®¡é˜…æ„è§ï¼š\\[15ex]%
      \hfill\makebox[5cm][l]{ç­¾åï¼š}%
      \makebox[5cm][r]{å¹´\qquad{}æœˆ\qquad{}æ—¥}\\
    \end{tblr}\\[1pt]
    æ³¨ï¼šæœ¬è¡¨å¤åˆ¶æœ‰æ•ˆ}}

\setlength{\parindent}{2em}

\pagestyle{empty}
