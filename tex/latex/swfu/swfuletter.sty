\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{swfuletter}

\RequirePackage[svgnames]{xcolor} % don't move this line

\RequirePackage{fontspec}
\newfontfamily\han{Noto Serif CJK SC}%￥, Noto Sans Mono CJK SC

\RequirePackage{graphicx}
\RequirePackage{tikz}

\usetikzlibrary{%
  calc,positioning,%
  backgrounds,%
}%

\RequirePackage{draftwatermark}
\SetWatermarkScale{.7}% .09 for full logo
\SetWatermarkAngle{0}
\SetWatermarkHorCenter{.5\paperwidth}% .48 for full logo
\SetWatermarkVerCenter{.09\paperheight}
\SetWatermarkText{\includegraphics[width=1.2\textwidth]{swfulogo-text}}

\RequirePackage{fancyhdr}

\fancypagestyle{plain}{%
  \fancyhf{}%
  \renewcommand{\headrule}{\vbox to 0pt%
    {\makebox[\headwidth]{\textcolor{Green}{\rule{\linewidth}{2pt}}}\vss}}
  \renewcommand{\footrule}{\vbox to 0pt%
    {\makebox[\headwidth]{\textcolor{Green}{\rule{\linewidth}{1pt}}}\vss}}
  \renewcommand{\headrulewidth}{2pt}
  \renewcommand{\footrulewidth}{1pt}
  \fancyfoot[L]{\fontsize{10}{10}\selectfont\textcolor{Green}{%
      \han{地址：云南省昆明市盘龙区白龙寺300号\qquad{}邮编：650224}}}
}
\fancypagestyle{empty}{%
  \fancyhf{}%
  \renewcommand{\headrule}{\vbox to 0pt%
    {\makebox[\headwidth]{\textcolor{Green}{\rule{\linewidth}{2pt}}}\vss}}
  \renewcommand{\footrule}{\vbox to 0pt%
    {\makebox[\headwidth]{\textcolor{Green}{\rule{\linewidth}{1pt}}}\vss}}
  \renewcommand{\headrulewidth}{2pt}
  \renewcommand{\footrulewidth}{1pt}
  \fancyfoot[L]{\fontsize{10}{10}\selectfont\textcolor{Green}{%
      \han{地址：云南省昆明市盘龙区白龙寺300号\qquad{}邮编：650224}}}
}

\pagestyle{plain}

% \newcommand\firstpagerule{%
%   \begin{tikzpicture}[overlay,remember picture]
%     \node at (current page.north) [yshift=-115pt,Green] {\rule{\linewidth}{2pt}};
%     \node (foot) at (current page.south) [yshift=27mm,Green] {\rule{\linewidth}{1pt}};
%     \node (han) [below=-5pt of foot.south west, anchor=north west, %
%     Green, font=\footnotesize] {%scale=.65
%       \han{地址：云南省昆明市盘龙区白龙寺300号\qquad{}邮编：650224}};
%     % \node (en) [below=-3pt of han.south west, anchor=north west, %
%     % Green, font=\footnotesize] {
%     %   № 300, Bailongsi, Panlongqu, Kunming 650224, China
%     % };
%   \end{tikzpicture}
%   % \tikz[overlay,remember picture]{%
%   %   \node at (current page.north) [yshift=-115pt,Green] {\rule{\linewidth}{2pt}};
%   % }
% }

\newcommand\sign[3]{\tikz[baseline,overlay,inner sep=0pt]{
    \node (sig) at (#3) [opacity=.7] { \includegraphics[width=3cm]{#1}};
    \node (seal) [below=20pt of sig.south, anchor=west, opacity=.5] {%
      \includegraphics[width=3.5cm]{#2}};
  }}